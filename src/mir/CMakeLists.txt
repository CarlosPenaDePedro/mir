### config headers

ecbuild_generate_config_headers( DESTINATION $ {INSTALL_INCLUDE_DIR}/mir )

configure_file( api/mir_config.h.in   api/mir_config.h  )
configure_file( api/mir_version.h.in  api/mir_version.h )

install(
  FILES
    ${CMAKE_CURRENT_BINARY_DIR}/api/mir_config.h
    ${CMAKE_CURRENT_BINARY_DIR}/api/mir_version.h
  DESTINATION
    ${INSTALL_INCLUDE_DIR}/mir
  )


### mir sources

configure_file( api/mir_version.cc.in  api/mir_version.cc )

list(
  APPEND mir_srcs
    action/Action.cc
    action/Action.h
    action/ActionPlan.cc
    action/ActionPlan.h
    action/filter/BitmapFilter.cc
    action/filter/BitmapFilter.h
    action/filter/FrameFilter.cc
    action/filter/FrameFilter.h
    action/interpolate/Gridded2GriddedInterpolation.cc
    action/interpolate/Gridded2GriddedInterpolation.h
    action/interpolate/Gridded2Octahedral.cc
    action/interpolate/Gridded2Octahedral.h
    action/interpolate/Gridded2ReducedGG.cc
    action/interpolate/Gridded2ReducedGG.h
    action/interpolate/Gridded2ReducedLL.cc
    action/interpolate/Gridded2ReducedLL.h
    action/interpolate/Gridded2RegularGG.cc
    action/interpolate/Gridded2RegularGG.h
    action/interpolate/Gridded2RegularLL.cc
    action/interpolate/Gridded2RegularLL.h
    action/interpolate/Gridded2RotatedLL.cc
    action/interpolate/Gridded2RotatedLL.h
    action/interpolate/Gridded2RotatedOctahedral.cc
    action/interpolate/Gridded2RotatedOctahedral.h
    action/interpolate/Gridded2RotatedReduced.cc
    action/interpolate/Gridded2RotatedReduced.h
    action/interpolate/Gridded2RotatedRegular.cc
    action/interpolate/Gridded2RotatedRegular.h
    action/misc/AreaCropper.cc
    action/misc/AreaCropper.h
    action/transform/Sh2GriddedTransform.cc
    action/transform/Sh2GriddedTransform.h
    action/transform/Sh2Octahedral.cc
    action/transform/Sh2Octahedral.h
    action/transform/Sh2ReducedGG.cc
    action/transform/Sh2ReducedGG.h
    action/transform/Sh2RegularGG.cc
    action/transform/Sh2RegularGG.h
    action/transform/Sh2RegularLL.cc
    action/transform/Sh2RegularLL.h
    action/transform/Sh2ShTransform.cc
    action/transform/Sh2ShTransform.h
    action/transform/VOD2UVTransform.cc
    action/transform/VOD2UVTransform.h
    api/emoslib.cc
    api/emoslib.h
    api/MIRJob.cc
    api/MIRJob.h
    data/MIRField.cc
    data/MIRField.h
    input/DummyInput.cc
    input/DummyInput.h
    input/GribFileInput.cc
    input/GribFileInput.h
    input/GribInput.cc
    input/GribInput.h
    input/GribMemoryInput.cc
    input/GribMemoryInput.h
    input/GribStreamInput.cc
    input/GribStreamInput.h
    input/MIRInput.cc
    input/MIRInput.h
    input/NetcdfFileInput.cc
    input/NetcdfFileInput.h
    input/VODInput.cc
    input/VODInput.h
    logic/AutoReduced.cc
    logic/AutoReduced.h
    logic/AutoResol.cc
    logic/AutoResol.h
    logic/MARSLogic.cc
    logic/MARSLogic.h
    logic/MIRLogic.cc
    logic/MIRLogic.h
    logic/ToolLogic.cc
    logic/ToolLogic.h
    lsm/AutoLSM.cc
    lsm/AutoLSM.h
    lsm/GribFileLSM.cc
    lsm/GribFileLSM.h
    lsm/LandSeaMasks.cc
    lsm/LandSeaMasks.h
    lsm/LSMChooser.cc
    lsm/LSMChooser.h
    lsm/Mask.cc
    lsm/Mask.h
    lsm/NoneLSM.cc
    lsm/NoneLSM.h
    lsm/UserFileLSM.cc
    lsm/UserFileLSM.h
    method/Bilinear.cc
    method/Bilinear.h
    method/FiniteElement.cc
    method/FiniteElement.h
    method/KNearest.cc
    method/KNearest.h
    method/Method.cc
    method/Method.h
    method/MethodWeighted.cc
    method/MethodWeighted.h
    method/PseudoLaplace.cc
    method/PseudoLaplace.h
    method/redist/Redist.cc
    method/redist/Redist.h
    method/WeightCache.cc
    method/WeightCache.h
    method/WeightMatrix.h
    output/DummyOutput.cc
    output/DummyOutput.h
    output/GribFileOutput.cc
    output/GribFileOutput.h
    output/GribMemoryOutput.cc
    output/GribMemoryOutput.h
    output/GribOutput.cc
    output/GribOutput.h
    output/GribStreamOutput.cc
    output/GribStreamOutput.h
    output/MIROutput.cc
    output/MIROutput.h
    output/UVOutput.cc
    output/UVOutput.h
    param/DelayedParametrisation.cc
    param/DelayedParametrisation.h
    param/FieldParametrisation.cc
    param/FieldParametrisation.h
    param/MIRArgs.cc
    param/MIRArgs.h
    param/MIRCombinedParametrisation.cc
    param/MIRCombinedParametrisation.h
    param/MIRConfiguration.cc
    param/MIRConfiguration.h
    param/MIRDefaults.cc
    param/MIRDefaults.h
    param/MIRParametrisation.cc
    param/MIRParametrisation.h
    param/RuntimeParametrisation.cc
    param/RuntimeParametrisation.h
    param/SimpleParametrisation.cc
    param/SimpleParametrisation.h
    repres/Gridded.cc
    repres/Gridded.h
    repres/latlon/LatLon.cc
    repres/latlon/LatLon.h
    repres/latlon/ReducedLL.cc
    repres/latlon/ReducedLL.h
    repres/latlon/RegularLL.cc
    repres/latlon/RegularLL.h
    repres/latlon/RotatedLL.cc
    repres/latlon/RotatedLL.h
    repres/reduced/Classic.cc
    repres/reduced/Classic.h
    repres/reduced/FromPL.cc
    repres/reduced/FromPL.h
    repres/reduced/Octahedral.cc
    repres/reduced/Octahedral.h
    repres/reduced/ReducedClassic.cc
    repres/reduced/ReducedClassic.h
    repres/reduced/ReducedFromPL.cc
    repres/reduced/ReducedFromPL.h
    repres/reduced/ReducedOctahedral.cc
    repres/reduced/ReducedOctahedral.h
    repres/reduced/RotatedClassic.cc
    repres/reduced/RotatedClassic.h
    repres/reduced/RotatedFromPL.cc
    repres/reduced/RotatedFromPL.h
    repres/reduced/RotatedOctahedral.cc
    repres/reduced/RotatedOctahedral.h
    repres/regular/RegularGG.cc
    repres/regular/RegularGG.h
    repres/Representation.cc
    repres/Representation.h
    repres/sh/SphericalHarmonics.cc
    repres/sh/SphericalHarmonics.h
    repres/unsupported/Albers.cc
    repres/unsupported/Albers.h
    repres/unsupported/AzimuthRange.cc
    repres/unsupported/AzimuthRange.h
    repres/unsupported/EquatorialAzimuthalEquidistant.cc
    repres/unsupported/EquatorialAzimuthalEquidistant.h
    repres/unsupported/IrregularLatlon.cc
    repres/unsupported/IrregularLatlon.h
    repres/unsupported/Lambert.cc
    repres/unsupported/Lambert.h
    repres/unsupported/LambertAzimuthalEqualArea.cc
    repres/unsupported/LambertAzimuthalEqualArea.h
    repres/unsupported/Mercator.cc
    repres/unsupported/Mercator.h
    repres/unsupported/PolarStereographic.cc
    repres/unsupported/PolarStereographic.h
    repres/unsupported/RotatedSH.cc
    repres/unsupported/RotatedSH.h
    repres/unsupported/SpaceView.cc
    repres/unsupported/SpaceView.h
    repres/unsupported/StretchedGG.cc
    repres/unsupported/StretchedGG.h
    repres/unsupported/StretchedLL.cc
    repres/unsupported/StretchedLL.h
    repres/unsupported/StretchedRotatedGG.cc
    repres/unsupported/StretchedRotatedGG.h
    repres/unsupported/StretchedRotatedLL.cc
    repres/unsupported/StretchedRotatedLL.h
    repres/unsupported/StretchedRotatedSH.cc
    repres/unsupported/StretchedRotatedSH.h
    repres/unsupported/StretchedSH.cc
    repres/unsupported/StretchedSH.h
    repres/unsupported/TransverseMercator.cc
    repres/unsupported/TransverseMercator.h
    repres/unsupported/TriangularGrid.cc
    repres/unsupported/TriangularGrid.h
    repres/unsupported/UnstructuredGrid.cc
    repres/unsupported/UnstructuredGrid.h
    util/Arguments.cc
    util/Arguments.h
    util/Bitmap.cc
    util/Bitmap.h
    util/BoundingBox.cc
    util/BoundingBox.h
    util/Grib.h
    util/Increments.cc
    util/Increments.h
    util/Parser.cc
    util/Parser.h
    util/ParserConsumer.cc
    util/ParserConsumer.h
    util/PointSearch.cc
    util/PointSearch.h
    util/Rotation.cc
    util/Rotation.h
  )


ecbuild_add_library(
  TARGET             mir
  INSTALL_HEADERS    LISTED
  HEADER_DESTINATION ${INSTALL_INCLUDE_DIR}/mir
  SOURCES            ${mir_srcs}
  GENERATED          api/mir_version.cc
  INCLUDES           ${ECKIT_INCLUDE_DIRS} ${NETCDF_INCLUDE_DIRS}
  LIBS               ${ATLAS_LIBRARIES} ${ECKIT_LIBRARIES} ${NETCDF_LIBRARIES}
  )


